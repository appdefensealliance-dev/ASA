# Application Security Guide

## Version History
| Version | Date | Description |
| ----- | ----- | --------------- |
| 0.50 | 11/15/2021 | Initial version based on OWASP ASVS 4.0.3 |

## [V1 Architecture, Design and Threat Modeling Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v1-architecture-design-and-threat-modeling)
| ID | Criteria | Summary |
| -- | ---------- | ---------------------- |
| [V1.2 Authentication Architecture](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v12-authentication-architecture) | 1.2.1<br>1.2.2<br>1.2.3<br>1.2.4 | When designing authentication, it doesn't matter if you have strong hardware enabled multi-factor authentication if an attacker can reset an account by calling a call center and answering commonly known questions. When proving identity, all authentication pathways must have the same strength.|
| [V1.4 Access Control Architectural](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v14-access-control-architecture)  | 1.4.1<br>1.4.3<br>1.4.4 | The application shall use a single and well-vetted access control mechanism for accessing protected data and resources. Access controls shall never be enforced from the client.|
| [V1.5 Input and Output Architectural](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v15-input-and-output-architecture) | 1.5.3 | Verify that input validation is enforced on a trusted service layer. |
| [V1.6 Cryptographic Architecture](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v16-cryptographic-architecture) | 1.6.2 | Applications need to be designed with strong cryptographic architecture to protect data assets as per their classification. Encrypting everything is wasteful, not encrypting anything is legally negligent. A balance must be struck, usually during architectural or high level design, design sprints or architectural spikes. Designing cryptography as you go or retrofitting it will inevitably cost much more to implement securely than simply building it in from the start. <br><br>Architectural requirements are intrinsic to the entire code base, and thus difficult to unit or integrate test. Architectural requirements require consideration in coding standards, throughout the coding phase, and should be reviewed during security architecture, peer or code reviews, or retrospectives. |
|[V1.7 Errors, Logging and Auditing Architecture](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v17-errors-logging-and-auditing-architecture) | 1.7.2 | Logs shall be securely transmitted to a preferably remote system for analysis, detection, alerting, and escalation. |
|[V1.9 Communications Architecture](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v19-communications-architecture) | 1.9.1<br>1.9.2 | The application encrypts communications between components, particularly when these components are in different containers, systems, sites, or cloud providers. <br><br>The application components shall also verify the authenticity of each side in a communication link to prevent person-in-the-middle attacks. For example, application components should validate TLS certificates and chains.|
| [V1.12 Secure File Upload Architectural](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v112-secure-file-upload-architecture) | 1.12.2 | Verify that user-uploaded files - if required to be displayed or downloaded from the application - are served by either octet stream downloads, or from an unrelated domain, such as a cloud file storage bucket. Implement a suitable Content Security Policy (CSP) to reduce the risk from XSS vectors or other attacks from the uploaded file.|
| [V1.14 Configuration Architecture](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x10-V1-Architecture.md#v114-configuration-architecture)| 1.14.1<br>1.14.2<br>1.14.6|The application shall have segregation of components of differing trust levels through well-defined security controls, firewall rules, API gateways, reverse proxies, cloud-based security groups, or similar mechanisms.<br><br>Binary signatures, trusted connections, and verified endpoints are used to deploy binaries to remote devices and the build pipeline warns of out-of-date or insecure components and takes appropriate actions.|

## [V2 Authentication Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v2-authentication)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V2.1 Password Security](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v21-password-security)| 2.1.1 <br>2.1.2 <br>2.1.3 <br>2.1.4 <br>2.1.5 <br>2.1.6 <br>2.1.7 <br>2.1.8 <br>2.1.9 <br>2.1.10 <br>2.1.11 <br>2.1.12|Passwords, called "Memorized Secrets" by NIST 800-63, include passwords, PINs, unlock patterns, pick the correct kitten or another image element, and passphrases. They are generally considered "something you know", and often used as single-factor authenticators. There are significant challenges to the continued use of single-factor authentication, including billions of valid usernames and passwords disclosed on the Internet, default or weak passwords, rainbow tables and ordered dictionaries of the most common passwords.<br><br>Applications should strongly encourage users to enroll in multi-factor authentication, and should allow users to re-use tokens they already possess, such as FIDO or U2F tokens, or link to a credential service provider that provides multi-factor authentication.<br><br>Credential Service Providers (CSPs) provide federated identity for users. Users will often have more than one identity with multiple CSPs, such as an enterprise identity using Azure AD, Okta, Ping Identity or Google, or consumer identity using Facebook, Twitter, Google, or WeChat, to name a just few common alternatives. This list is not an endorsement of these companies or services, but simply an encouragement for developers to consider the reality that many users have many established identities. Organizations should consider integrating with existing user identities, as per the risk profile of the CSP's strength of identity proofing. For example, it is unlikely a government organization would accept a social media identity as a login for sensitive systems, as it is easy to create fake or throw away identities, whereas a mobile game company may well need to integrate with major social media platforms to grow their active player base.|
|[V2.2 General Authenticator](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v22-general-authenticator-security)| 2.2.1 <br>2.2.2 <br>2.2.3 |Authenticator agility is essential to future-proof applications. Refactor application verifiers to allow additional authenticators as per user preferences, as well as allowing retiring deprecated or unsafe authenticators in an orderly fashion.<br><br>NIST considers email and SMS as "restricted" authenticator types, and they are likely to be removed from NIST 800-63 and thus the ASVS at some point the future. Applications should plan a roadmap that does not require the use of email or SMS.|
| [V2.3 Authenticator Lifecycle](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v23-authenticator-lifecycle)| 2.3.1 <br>2.3.2| Authenticators are passwords, soft tokens, hardware tokens, and biometric devices. The lifecycle of authenticators is critical to the security of an application - if anyone can self-register an account with no evidence of identity, there can be little trust in the identity assertion. For social media sites like Reddit, that's perfectly okay. For banking systems, a greater focus on the registration and issuance of credentials and devices is critical to the security of the application.|
|[V2.5 Credential Recovery](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v25-credential-recovery) | 2.5.1 <br>2.5.2 <br>2.5.3 <br>2.5.4 <br>2.5.5 <br>2.5.6 <br>2.5.7| Initial activation or credential recovery shall follow security best practices and not expose the current or new password in anyway. |
|[V2.6 Look-up Secret Verifier](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v26-look-up-secret-verifier) | 2.6.1 <br>2.6.2 <br>2.6.3| Look up secrets are pre-generated lists of secret codes, similar to Transaction Authorization Numbers (TAN), social media recovery codes, or a grid containing a set of random values. These are distributed securely to users. These lookup codes are used once, and once all used, the lookup secret list is discarded. This type of authenticator is considered "something you have". |
|[V2.7 Out of Band Verifier](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v27-out-of-band-verifier)| 2.7.1 <br>2.7.2 <br>2.7.3 <br>2.7.4 <br>2.7.6|In the past, a common out of band verifier would have been an email or SMS containing a password reset link. Attackers use this weak mechanism to reset accounts they don't yet control, such as taking over a person's email account and re-using any discovered reset links. There are better ways to handle out of band verification. <br><br>Secure out of band authenticators are physical devices that can communicate with the verifier over a secure secondary channel. Examples include push notifications to mobile devices. This type of authenticator is considered "something you have". When a user wishes to authenticate, the verifying application sends a message to the out of band authenticator via a connection to the authenticator directly or indirectly through a third party service. The message contains an authentication code (typically a random six digit number or a modal approval dialog). The verifying application waits to receive the authentication code through the primary channel and compares the hash of the received value to the hash of the original authentication code. If they match, the out of band verifier can assume that the user has authenticated. <br><br>The ASVS assumes that only a few developers will be developing new out of band authenticators, such as push notifications, and thus the following ASVS controls apply to verifiers, such as authentication API, applications, and single sign-on implementations. If developing a new out of band authenticator, please refer to NIST 800-63B § 5.1.3.1. <br><br>Unsafe out of band authenticators such as e-mail and VOIP are not permitted. PSTN and SMS authentication are currently "restricted" by NIST and should be deprecated in favor of push notifications or similar. If you need to use telephone or SMS out of band authentication, please see § 5.1.3.3. |
|[V2.8 Single or Multi-factor One Time Verifier](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v28-one-time-verifier) | 2.8.1 <br>2.8.2 <br>2.8.4 <br>2.8.5 <br>2.8.6 <br>2.8.7| Single-factor One-time Passwords (OTPs) are physical or soft tokens that display a continually changing pseudo-random one-time challenge. These devices make phishing (impersonation) difficult, but not impossible. This type of authenticator is considered "something you have". Multi-factor tokens are similar to single-factor OTPs, but require a valid PIN code, biometric unlocking, USB insertion or NFC pairing or some additional value (such as transaction signing calculators) to be entered to create the final OTP.|
|[V2.10 Service Authentication](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x11-V2-Authentication.md#v210-service-authentication) | 2.10.1 <br>2.10.2| This section is not penetration testable, so does not have any L1 requirements. However, if used in an architecture, coding or secure code review, please assume that software (just as Java Key Store) is the minimum requirement at L1. Clear text storage of secrets is not acceptable under any circumstances.|

## [V3 Session Management Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v3-session-management)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V3.1 Fundmental Session Management](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v31-fundamental-session-management-security)| 3.1.1| The application shall never reveals session tokens in URL parameters.|
| [V3.2 Session Binding](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v32-session-binding)| 3.2.1 <br>3.2.2 <br>3.2.3| The application shall generate a new session token on user authentication. The token shall have at least 64 bits of entropy, and shall only store session tokens in the browser using secure methods.|
| [V3.3 Session Logout and Timeout](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v33-session-termination)| 3.3.1 <br>3.3.2 <br>3.3.3 <br>3.3.4| Session timeouts have been aligned with NIST 800-63, which permits much longer session timeouts than traditionally permitted by security standards. Organizations should review the table below, and if a longer time out is desirable based around the application's risk, the NIST value should be the upper bounds of session idle timeouts.|
| [V3.4 Cookie-based Session Management](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v34-cookie-based-session-management)| 3.4.1 <br>3.4.2 <br>3.4.3 <br>3.4.4 <br>3.4.5| Token-based session management includes JWT, OAuth, SAML, and API keys. Of these, API keys are known to be weak and should not be used in new code.|
| [V3.5 Token-based Session Management](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management)| 3.5.1 <br>3.5.2 <br>3.5.3| Token-based session management includes JWT, OAuth, SAML, and API keys. Of these, API keys are known to be weak and should not be used in new code.|
| [V3.7 Defenses Against Session Management Exploits](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v37-defenses-against-session-management-exploits)| 3.7.1| There are a small number of session management attacks, some related to the user experience (UX) of sessions. Previously, based on ISO 27002 requirements, the ASVS has required blocking multiple simultaneous sessions. Blocking simultaneous sessions is no longer appropriate, not only as modern users have many devices or the app is an API without a browser session, but in most of these implementations, the last authenticator wins, which is often the attacker. This section provides leading guidance on deterring, delaying and detecting session management attacks using code.|

## [V4 Access Control Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v4-access-control)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V4.1 General Access Control Design](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v41-general-access-control-design)| 4.1.1 <br>4.1.2 <br>4.1.3 <br>4.1.5| Access control rules shall be enforced on a trusted service layer and fail securely. Access control attributes shall be protected from unauthorized manipulation. The principle of least privilege shall be used for all access control policies.|
| [V4.2 Operation Level Access Control](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v42-operation-level-access-control)| 4.2.1 <br>4.2.2| Sensitive data and APIs are protected against Insecure Direct Object Reference (IDOR) attacks targeting creation, reading, updating and deletion of records, such as creating or updating someone else's record, viewing everyone's records, or deleting all records.  The application or framework shall also enforces a strong anti-CSRF mechanism to protect authenticated functionality, and effective anti-automation or anti-CSRF protects unauthenticated functionality.|
| [V4.3 Other Access Control Considerations](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V4-Access-Control.md#v43-other-access-control-considerations)| 4.3.1 <br>4.3.2 <br>4.3.3| Administrative interfaces shall use appropriate multi-factor authentication to prevent unauthorized use.<br>Directory browsing shall be disabled unless deliberately desired. Additionally, applications should not allow discovery or disclosure of file or directory metadata, such as Thumbs.db, .DS_Store, .git or .svn folders.<br>The application shall also have additional authorization (such as step up or adaptive authentication) for lower value systems, and / or segregation of duties for high value applications to enforce anti-fraud controls as per the risk of application and past fraud.|

## [V5 Validation, Sanitization and Encoding Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v5-validation-sanitization-and-encoding)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V5.1 Input Validation](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v51-input-validation)| 5.1.1 <br>5.1.2 <br>5.1.3 <br>5.1.4 <br>5.1.5| Properly implemented input validation controls, using positive allow lists and strong data typing, can eliminate more than 90% of all injection attacks. Length and range checks can reduce this further. Building in secure input validation is required during application architecture, design sprints, coding, and unit and integration testing. Although many of these items cannot be found in penetration tests, the results of not implementing them are usually found in V5.3 - Output encoding and Injection Prevention Requirements. Developers and secure code reviewers are recommended to treat this section as if L1 is required for all items to prevent injections.|
| [V5.2 Sanitization and Sandboxing](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing)| 5.2.1 <br>5.2.2 <br>5.2.3 <br>5.2.4 <br>5.2.5 <br>5.2.6 <br>5.2.7 <br>5.2.8| Input data shall be sanitized or sandboxed prior to use.|
| [V5.3 Output Encoding and Injection Prevention](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v53-output-encoding-and-injection-prevention)| 5.3.1 <br>5.3.2 <br>5.3.3 <br>5.3.4 <br>5.3.5 <br>5.3.6 <br>5.3.7 <br>5.3.8 <br>5.3.9 <br>5.3.10| Output encoding close or adjacent to the interpreter in use is critical to the security of any application. Typically, output encoding is not persisted, but used to render the output safe in the appropriate output context for immediate use. Failing to output encode will result in an insecure, injectable, and unsafe application.|
| [V5.4 Memory, String, and Unmanaged Code](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v54-memory-string-and-unmanaged-code)| 5.4.2| Verify that format strings do not take potentially hostile input, and are constant.|
| [V5.5 Deserialization Prevention](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention)| 5.5.1 <br>5.5.2| Serialized objects shall use integrity checks or are encrypted to prevent hostile object creation or data tampering.<br>The application shall correctly restricts XML parsers to only use the most restrictive configuration possible and to ensure that unsafe features such as resolving external entities are disabled to prevent XML eXternal Entity (XXE) attacks. |

## [V6 Stored Cryptography Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v6-stored-cryptography)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V6.4 Secret Management](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v64-secret-management)| 6.4.1| A secrets management solution such as a key vault shall be used to securely create, store, control access to and destroy secrets.|


## [V7 Error Handling and Logging Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x15-V7-Error-Logging.md#v7-error-handling-and-logging)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V7.4 Error Handling](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x15-V7-Error-Logging.md#v74-error-handling)| 7.4.1 <br>7.4.2| The purpose of error handling is to allow the application to provide security relevant events for monitoring, triage and escalation. The purpose is not to create logs. When logging security related events, ensure that there is a purpose to the log, and that it can be distinguished by SIEM or analysis software.|


## [V8 Data Protection Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v8-data-protection)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V8.1 General Data Protection](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v81-general-data-protection)| 8.1.4| The application shall detect and alert on abnormal numbers of requests, such as by IP, user, total per hour or day, or whatever makes sense for the application.|
| [V8.2 Client-side Data Protection](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v82-client-side-data-protection)| 8.2.1 <br>8.2.2 <br>8.2.3| The application shall set sufficient anti-caching headers so that sensitive data is not cached in modern browsers.<br>Authenticated data shall be cleared from client storage, such as the browser DOM, after the client or session is terminated.|
| [V8.3 Sensitive Private Data](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x16-V8-Data-Protection.md#v83-sensitive-private-data)| 8.3.1 <br>8.3.2| This section helps protect sensitive data from being created, read, updated, or deleted without authorization, particularly in bulk quantities. <br><br>Compliance with this section implies compliance with V4 Access Control, and in particular V4.2. For example, to protect against unauthorized updates or disclosure of sensitive personal information requires adherence to V4.2.1. Please comply with this section and V4 for full coverage.|

## [V9 Communications Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v9-communication)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V9.1 Client Communications Security](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v91-client-communication-security)| 9.1.1 <br>9.1.2 <br>9.1.3| Ensure all client messages are sent over encrypted networks, using TLS 1.2 or later. Use up to date tools to review the client configuration on a regular basis|
| [V9.2 Server Communications Security](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x17-V9-Communications.md#v92-server-communication-security)| 9.2.1 <br>9.2.2 <br>9.2.3 <br>9.2.4| Server communications are more than just HTTP. Secure connections to and from other systems, such as monitoring systems, management tools, remote access and ssh, middleware, database, mainframes, partner or external source systems — must be in place. All of these must be encrypted to prevent "hard on the outside, trivially easy to intercept on the inside".|


## [V10 Malicious Code Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x18-V10-Malicious.md#v10-malicious-code)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V10.2 Malicious Code Search](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x18-V10-Malicious.md#v102-malicious-code-search)| 10.2.1 <br>10.2.2| Malicious code is extremely rare and is difficult to detect. Manual line by line code review can assist looking for logic bombs, but even the most experienced code reviewer will struggle to find malicious code even if they know it exists. <br><br>Complying with this section is not possible without complete access to source code, including third-party libraries.|
| [V10.3 Deployed Application Integrity Controls](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x18-V10-Malicious.md#v103-application-integrity)| 10.3.1 <br>10.3.2 <br>10.3.3| Once an application is deployed, malicious code can still be inserted. Applications need to protect themselves against common attacks, such as executing unsigned code from untrusted sources and subdomain takeovers.|


## [V11 Business Logic Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x19-V11-BusLogic.md#v11-business-logic)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V11.1 Business Logic Security](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x19-V11-BusLogic.md#v111-business-logic-security)| 11.1.1 <br>11.1.2 <br>11.1.3 <br>11.1.4 <br>11.1.6| Business logic security is so individual to every application that no one checklist will ever apply. Business logic security must be designed in to protect against likely external threats - it cannot be added using web application firewalls or secure communications. We recommend the use of threat modeling during design sprints, for example using the OWASP Cornucopia or similar tools.|

## [V12 File and Resources Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x20-V12-Files-Resources.md#v12-files-and-resources)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V12.1 File Upload](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x20-V12-Files-Resources.md#v121-file-upload)| 12.1.1 <br>12.1.3| Although zip bombs are eminently testable using penetration testing techniques, they are considered L2 and above to encourage design and development consideration with careful manual testing, and to avoid automated or unskilled manual penetration testing of a denial of service condition.|
| [V12.3 File Execution](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x20-V12-Files-Resources.md#v123-file-execution)| 12.3.1 <br>12.3.3 <br>12.3.4 <br>12.3.6|  User-submitted filename metadata shall not used directly by system or framework filesystems and that a URL API is used to protect against path traversal.<br<User-submitted filename metadata is validated or ignored to prevent the disclosure or execution of remote files via Remote File Inclusion (RFI) or Server-side Request Forgery (SSRF) attacks.<br>The application protects against Reflective File Download (RFD) by validating or ignoring user-submitted filenames in a JSON, JSONP, or URL parameter, the response Content-Type header should be set to text/plain, and the Content-Disposition header should have a fixed filename.<br>The application shall not include and execute functionality from untrusted sources, such as unverified content distribution networks, JavaScript libraries, node npm libraries, or server-side DLLs.|
| [V12.5 File Download](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x20-V12-Files-Resources.md#v125-file-download)| 12.5.1 <br>12.5.2| The web tier shall be configured to serve only files with specific file extensions to prevent unintentional information and source code leakage.<br>Direct requests to uploaded files shall never be executed as HTML/JavaScript content.|
| [V12.6 SSRF Protection](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x20-V12-Files-Resources.md#v126-ssrf-protection)| 12.6.1| The application server is configured with an allow list of resources or systems to which the server can send requests or load data/files from.|

## [V13 API and Web Service Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v13-api-and-web-service)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V13.1 Generic Web Service Security Verification](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v131-generic-web-service-security)| 13.1.1 <br>13.1.3 <br>13.1.4 <br>13.1.5| API URLs shall not expose sensitive information, such as the API key, session tokens etc. and  authorization decisions shall be made at both the URI, enforced by programmatic or declarative security at the controller or router, and at the resource level, enforced by model-based permissions.<br> All application components use the same encodings and parsers to avoid parsing attacks that exploit different URI or file parsing behavior that could be used in SSRF and RFI attacks|
| [V13.2 RESTful Web Service Verification](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v132-restful-web-service)| 13.2.1 <br>13.2.2 <br>13.2.3 <br>13.2.5 <br>13.2.6| JSON schema validation is in a draft stage of standardization (see references). When considering using JSON schema validation, which is best practice for RESTful web services, consider using these additional data validation strategies in combination with JSON schema validation: <br><br>Parsing validation of the JSON object, such as if there are missing or extra elements. <br><br>Validation of the JSON object values using standard input validation methods, such as data type, data format, length, etc. and formal JSON schema validation. <br><br>Once the JSON schema validation standard is formalized, ASVS will update its advice in this area. Carefully monitor any JSON schema validation libraries in use, as they will need to be updated regularly until the standard is formalized and bugs are ironed out of reference implementations.|
| [V13.3 SOAP Web Service Verification](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v133-soap-web-service)| 13.3.1 <br>13.3.2| XSD schema validation shall take place to ensure a properly formed XML document, followed by validation of each input field before any processing of that data takes place.<br>The message payload shall be signed using WS-Security to ensure reliable transport between client and service.|
| [V13.4 GraphQL and other Web Service Data Layer Security](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x21-V13-API.md#v134-graphql)| 13.4.1| GraphQL or other data layer authorization logic should be implemented at the business logic layer instead of the GraphQL layer.|

## [V14 Configuration Verification Requirements](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v14-configuration)
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| [V14.1 Build](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v141-build-and-deploy)| 14.1.3| Build pipelines are the basis for repeatable security - every time something insecure is discovered, it can be resolved in the source code, build or deployment scripts, and tested automatically. We are strongly encouraging the use of build pipelines with automatic security and dependency checks that warn or break the build to prevent known security issues being deployed into production. Manual steps performed irregularly directly leads to avoidable security mistakes. <br><br>As the industry moves to a DevSecOps model, it is important to ensure the continued availability and integrity of deployment and configuration to achieve a "known good" state. In the past, if a system was hacked, it would take days to months to prove that no further intrusions had taken place. Today, with the advent of software defined infrastructure, rapid A/B deployments with zero downtime, and automated containerized builds, it is possible to automatically and continuously build, harden, and deploy a "known good" replacement for any compromised system. <br><br>If traditional models are still in place, then manual steps must be taken to harden and back up that configuration to allow the compromised systems to be quickly replaced with high integrity, uncompromised systems in a timely fashion. <br><br>Compliance with this section requires an automated build system, and access to build and deployment scripts.|
| [V14.2 Dependency](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v142-dependency)| 14.2.1 <br>14.2.5| Dependency management is critical to the safe operation of any application of any type. Failure to keep up to date with outdated or insecure dependencies is the root cause of the largest and most expensive attacks to date.|
| [V14.3 Unintended Security Disclosure](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v143-unintended-security-disclosure)| 14.3.2 <br>14.3.3| Configurations for production should be hardened to protect against common attacks, such as debug consoles, raise the bar for Cross-site Scripting (XSS) and Remote File Inclusion (RFI) attacks, and to eliminate trivial information discovery "vulnerabilities" that are the unwelcome hallmark of many penetration testing reports. Many of these issues are rarely rated as a significant risk, but they are chained together with other vulnerabilities. If these issues are not present by default, it raises the bar before most attacks can succeed.|
| [V14.4 HTTP Security Headers](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v144-http-security-headers)| 14.4.1 <br>14.4.2 <br>14.4.3 <br>14.4.4 <br>14.4.5 <br>14.4.6 <br>14.4.7| The application shall use the recomended security headers.|
| [V14.5 Validate HTTP Request Header](https://github.com/OWASP/ASVS/blob/master/4.0/en/0x22-V14-Config.md#v145-http-request-header-validation)| 14.5.1 <br>14.5.2 <br>14.5.3 <br>14.5.4| The application shall validate the HTTP request headers.|

## V20 Policy and Procedure Requirements
| ID | Criteria | Summary |
| ---------- | ---------- | ---------------------- |
| 20.1 Incident Response Plan | [Computer Security Incident Handling Guide](https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final) | Establishes roles, responsibilities, and actions when an incident occurs |
| 20.2 Risk Management Policy | | Identifies, reduces, and prevents undesirable incidents or outcomes |
| 20.3 Vulnerability Disclosure Program | [Vulnerability Disclosure Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Vulnerability_Disclosure_Cheat_Sheet.html) | Provides a means for external parties to report vulnerabilities |
| 20.4 Information Security Policy | | Ensures that all users comply with rules and guidelines related to the security of the information stored digitally at any point in the network |
| 20.5 Privacy User Data Detection | | Ensures that users can delete their accounts and related user data by demonstrating an account deletion if relevant |
